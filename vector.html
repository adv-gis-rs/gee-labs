<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>3301 - Introduction</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./colour-vis.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<link rel="stylesheet" href="styles.css">
</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./vector.html"><span class="chapter-title">Vector Data Operations</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">3301</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Home</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./js-introduction.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">JavaScript</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ee-introduction.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">GEE Introduction</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./colour-vis.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Color and Data Visualisation</span></a>
  </div>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./vector.html" class="sidebar-item-text sidebar-link active"><span class="chapter-title">Vector Data Operations</span></a>
  </div>
</li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#which-perth-university-has-the-greenest-and-coolest-campus" id="toc-which-perth-university-has-the-greenest-and-coolest-campus" class="nav-link active" data-scroll-target="#which-perth-university-has-the-greenest-and-coolest-campus">Which Perth university has the greenest and coolest campus?</a></li>
  <li><a href="#setup" id="toc-setup" class="nav-link" data-scroll-target="#setup">Setup</a></li>
  <li><a href="#data-import" id="toc-data-import" class="nav-link" data-scroll-target="#data-import">Data Import</a></li>
  <li><a href="#filter" id="toc-filter" class="nav-link" data-scroll-target="#filter">Filter</a></li>
  <li><a href="#buffer" id="toc-buffer" class="nav-link" data-scroll-target="#buffer">Buffer</a></li>
  <li><a href="#zonal-statistics" id="toc-zonal-statistics" class="nav-link" data-scroll-target="#zonal-statistics">Zonal Statistics</a></li>
  <li><a href="#join" id="toc-join" class="nav-link" data-scroll-target="#join">Join</a></li>
  <li><a href="#descriptive-statistics" id="toc-descriptive-statistics" class="nav-link" data-scroll-target="#descriptive-statistics">Descriptive Statistics</a></li>
  <li><a href="#visualisation" id="toc-visualisation" class="nav-link" data-scroll-target="#visualisation">Visualisation</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title"><span class="chapter-title">Introduction</span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p>This lab will introduce data transformation and manipulation operations for vector data.</p>
<!-- <div class="well well-sm">

<b>Quick recap:</b> In Google Earth Engine, vector data is represented using `Feature` objects which include a `geometry` property storing a `Geometry` object that describes the location, extent, and shape of the `Feature` and a `properties` dictionary object of attribute information describing non-spatial characteristics of the data. A collection of `Feature`s in Google Earth Engine is a `FeatureCollection`; for example, if each weather station is represented as a `Feature` then a group of weather stations could be stored as a `FeatureCollection` object. 

</div> -->
<p>Data transformation operations transform data into a format ready for subsequent analysis. For non-spatial data, common data transformation operations include filtering and subsetting observations, creating new variables through applying functions to existing variables, joining and combining data, and summarising or aggregating data. This characterisation of data transformation operations is based on <a href="https://r4ds.had.co.nz" target="_blank">Wickham and Grolemund (2017)</a>. For example, consider the following data transformation operations that could be applied to climate data:</p>
<ol type="1">
<li><em><b>Filter and subset:</b></em> filter the data for all observations that occurred within a time-period (e.g.&nbsp;since the year 2010) and select a variable of interest (e.g.&nbsp;temperature in Fahrenheit).</li>
<li><em><b>Create a new variable:</b></em> create a new variable (temperature in Celsius) by converting the observations of temperature in Fahrenheit using the equation: <span class="math inline">\(T_{(C^{o})} = (T_{(F^{o})} - 32) * 5/9\)</span>.</li>
<li><em><b>Join and combine:</b></em> join your temperature data to precipitation data (e.g.&nbsp;joining on weather station ID and date and time of weather observation).</li>
<li><em><b>Summarise:</b></em> summarise your data by computing the average daily temperature and precipitation for each weather station.</li>
</ol>
<p>Data transformation operations can be applied to the non-spatial attribute information associated with spatial <code>Feature</code> objects. However, most data transformation operations have a spatial equivalent. For example:</p>
<ol type="1">
<li><em><b>Filter and subset:</b></em> filter a <code>FeatureCollection</code> based on geographic location and topological relations (e.g.&nbsp;selecting only weather stations that intersect with the Western Australia extent or only weather stations within a 10,000 km radius from Perth).</li>
<li><em><b>Create a new variable:</b></em> the <code>Geometry</code> objects can be converted into spatial objects with new shapes or extents (e.g.&nbsp;through applying a 1 km buffer operation).</li>
<li><em><b>Join and combine:</b></em> spatial data can be combined through spatial join operations (e.g.&nbsp;join weather station data with Statistical Area Level 1 (SA1) polygon geometries based on the intersection between a weather station’s location and the extent of the SA1).</li>
<li><em><b>Join and combine AND create a new variable:</b></em> vector data can be combined with raster data via zonal statistics (e.g.&nbsp;computing the area of each land cover class within a polygon <code>Geometry</code>).</li>
<li><em><b>Summarise:</b></em> you could perform aggregations or summary operations for observations within a spatial extent (e.g compute the average temperature of all weather stations within each SA1 extent).</li>
</ol>
<p>This lab will demonstrate several spatial and non-spatial data transformation operations. These operations will form part of a workflow to address the question: <em>Which Perth university has the greenest and coolest campus?</em></p>
<section id="which-perth-university-has-the-greenest-and-coolest-campus" class="level3">
<h3 class="anchored" data-anchor-id="which-perth-university-has-the-greenest-and-coolest-campus">Which Perth university has the greenest and coolest campus?</h3>
<p>You will start with a <code>FeatureCollection</code> containing <code>Feature</code> objects of a building (a polygon <code>Geometry</code> object) and attribute information indicating if the building is part of a university (the <code>building</code> property), the name of the university (the <code>uni_name</code> property), and a building ID (the <code>osm_id</code> property).</p>
<p>The building footprint data are from <a href="https://wiki.openstreetmap.org/wiki/API_v0.6" target="_blank">Open Street Map</a> and include buildings from the University of Western Australia (UWA) Crawley Campus, Curtin University Bentley Campus, Murdoch University Perth (Murdoch) Campus, Edith Cowan University (ECU) Mount Lawley Campus, and some non-university buildings near to each campus.</p>
<p>You will use the area of tree canopy cover within a certain distance of a building as an indicator of greenness; the tree canopy data is in raster format and derived from the Urban Monitor data <a href="https://urbanmonitor-beta.landgate.wa.gov.au/content/app/urban-monitor-metadata-final-report.pdf" target="_blank">(Caccetta, 2012)</a>.</p>
<p>The temperature data is also in raster format and is a measure of average summer (December, January, and February) land surface temperature (LST) derived from Landsat 8 <a href="https://ieeexplore.ieee.org/document/6784508" target="_blank">(Jiménez-Muñoz et al.&nbsp;2014)</a>.</p>
<p>You will need to produce summary statistics that describe the greenness and temperature of each university campus.</p>
<p>Your analysis will comprise the following steps:</p>
<ol type="1">
<li><em><b>Filter and subset:</b></em> filter the building footprint <code>FeatureCollection</code> to include only university buildings.</li>
<li><em><b>Create a new variable:</b></em> perform a buffer operation on each university building footprint’s <code>Geometry</code> object.</li>
<li><em><b>Create a new variable:</b></em> compute the area of tree canopy cover within the buffer of each building footprint.</li>
<li><em><b>Create a new variable:</b></em> compute the average LST for each building’s buffer.</li>
<li><em><b>Join and combine:</b></em> join the area of tree canopy cover and average LST within each building’s buffer to a <code>FeatureCollection</code> storing the building footprint <code>Geometry</code>.</li>
<li><em><b>Summarise:</b></em> compute the average tree canopy cover and LST for buildings on each campus.</li>
</ol>
</section>
<section id="setup" class="level3">
<h3 class="anchored" data-anchor-id="setup">Setup</h3>
<p>Create a new script in your <em>labs-gee</em> repository called <em>Vector Data Operations</em>. Enter the following comment header to the script.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="co">/*</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="co">Vector Data Operations</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co">Author: Test</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="co">Date: XX-XX-XXXX</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="co">*/</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="data-import" class="level3">
<h3 class="anchored" data-anchor-id="data-import">Data Import</h3>
<p>Execute the following code to import the data. The OSM buildings near Perth university campuses are a <code>FeatureCollection</code> of building <code>Feature</code> objects. The Urban Monitor tree cover data are clips of the area surrounding each university campus from a larger raster layer. Import these four clipped rasters as <code>Image</code> objects and <code>mosaic()</code> them into one <code>Image</code>. Each 40 cm pixel in the <code>uniTree</code> <code>Image</code> has a value 1 if it covers a tree canopy and a masked no data value if not. The <code>multiply(ee.Image.pixelArea())</code> operation is converting the pixel value of one into the area of the pixel in square metres.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Data import</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="co">// Perth OSM university buildings and buildings near universities</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> perthBuildingOSM <span class="op">=</span> ee<span class="op">.</span><span class="fu">FeatureCollection</span>(<span class="st">'users/jmad1v07/gee-labs/perth-uni-osm'</span>)<span class="op">;</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(perthBuildingOSM)<span class="op">;</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="bu">Map</span><span class="op">.</span><span class="fu">centerObject</span>(perthBuildingOSM<span class="op">,</span> <span class="dv">13</span>)<span class="op">;</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="bu">Map</span><span class="op">.</span><span class="fu">addLayer</span>(perthBuildingOSM<span class="op">,</span> {<span class="dt">color</span><span class="op">:</span> <span class="st">'FF0000'</span>}<span class="op">,</span> <span class="st">'OSM buildings near Perth university campuses'</span>)<span class="op">;</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a><span class="co">// import urban monitor tree cover data</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> curtinTree <span class="op">=</span> ee<span class="op">.</span><span class="fu">Image</span>(<span class="st">'users/jmad1v07/gee-labs/curtin-tree-2016'</span>)<span class="op">;</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> ecuTree <span class="op">=</span> ee<span class="op">.</span><span class="fu">Image</span>(<span class="st">'users/jmad1v07/gee-labs/ecu-tree-2016'</span>)<span class="op">;</span></span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> murdochTree <span class="op">=</span> ee<span class="op">.</span><span class="fu">Image</span>(<span class="st">'users/jmad1v07/gee-labs/murdoch-tree-2016'</span>)<span class="op">;</span></span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> uwaTree <span class="op">=</span> ee<span class="op">.</span><span class="fu">Image</span>(<span class="st">'users/jmad1v07/gee-labs/uwa-tree-2016'</span>)<span class="op">;</span></span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a><span class="co">// mosaic urban monitor tree cover data covering Perth universities</span></span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> uniTree <span class="op">=</span> ee<span class="op">.</span><span class="fu">ImageCollection</span>([curtinTree<span class="op">,</span> ecuTree<span class="op">,</span> murdochTree<span class="op">,</span> uwaTree])<span class="op">.</span><span class="fu">mosaic</span>()<span class="op">;</span></span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(uniTree)<span class="op">;</span></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a><span class="co">// convert each pixel value to represent area of tree cover (SqM)</span></span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> uniTreePixelArea <span class="op">=</span> uniTree<span class="op">.</span><span class="fu">multiply</span>(ee<span class="op">.</span><span class="at">Image</span><span class="op">.</span><span class="fu">pixelArea</span>())<span class="op">;</span></span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(uniTreePixelArea)<span class="op">;</span></span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a><span class="co">// import Landsat 8 summer land surface temperature</span></span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> landsatLST <span class="op">=</span> ee<span class="op">.</span><span class="fu">Image</span>(<span class="st">'users/jmad1v07/gee-labs/landsat8-lst'</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Explore the <code>perthBuildingOSM</code> data in the map display and in the <em>console</em>.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="img/osm-building-footprint-uwa.png" class="img-fluid figure-img" style="width:85.0%"></p>
<figcaption class="figure-caption">OSM building footprints and properties near UWA.</figcaption>
</figure>
</div>
</div>
</div>
<br>
<details>
<summary>
<b><em>Can you visualise the <code>uniTree</code> <code>Image</code> on the map display? Look back to the previous lab for examples of how to visualise the Urban Monitor data and for appropriate colour schemes.</em></b>
</summary>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="co">// UM uni tree</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="bu">Map</span><span class="op">.</span><span class="fu">addLayer</span>(uniTree<span class="op">,</span> {<span class="dt">min</span><span class="op">:</span> <span class="dv">0</span><span class="op">,</span> <span class="dt">max</span><span class="op">:</span> <span class="dv">1</span><span class="op">,</span> <span class="dt">palette</span><span class="op">:</span>[<span class="st">'#009900'</span>]}<span class="op">,</span> <span class="st">'UM Tree'</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</details>
<p><br></p>
</section>
<section id="filter" class="level2">
<h2 class="anchored" data-anchor-id="filter">Filter</h2>
<p>Filtering subsets observations from your data based on their values <a href="https://r4ds.had.co.nz" target="_blank">(Wickham and Grolemund, 2017)</a>. In Google Earth Engine, comparison operators (e.g equals to <code>eq</code>, not equals to <code>neq</code>, less than <code>lt</code>, greater than <code>gt</code>) are used to filter observations based on attribute values.</p>
<!-- There are a range of in-built convenience `filter()` functions in Google Earth Engine that you can use for common filtering operations; for example, the following code snippet from [Lab 4a](lab-4.html) demonstrates the use of the in-built `filterDate()` function to filter a Landsat 8 `ImageCollection` using `Image` capture dates recorded in the metadata `properties` object. 

<br>


::: {.cell}

```{.js .cell-code}
// Landsat 8 Image Collection
var l8ImColl = ee.ImageCollection('LANDSAT/LC08/C01/T1_SR');

// Filter Image Collection for 2018
var l8ImColl = l8ImColl
  .filterBounds(ee.Geometry.Point(115.81237940701908,-31.9783567043356))
  .filterDate('2018-01-01', '2018-12-31');
print(l8ImColl); 
```
:::


<br>

<details>
  <summary><b>*Change the date range to see how many `Image`s are returned if you expand the date range to include 2017?*</b></summary>
  <p>
  <br>
  88 `Image`s
  

  ::: {.cell}
  
  ```{.js .cell-code}
  // Filter Image Collection for 2018
  var l8ImColl2017_2018 = l8ImColl
  .filterBounds(ee.Geometry.Point(115.81237940701908,-31.9783567043356))
  .filterDate('2017-01-01', '2018-12-31');
  print(l8ImColl2017_2018); 
  ```
  :::

  </p>
</details>
<br>

<details>
  <summary><b>*What spatial filtering operation are you applying to the Landsat 8 `ImageCollection`?*</b></summary>
  <p>
  <br>
  This filter returns all `Image`s from the Landsat 8 image collection whose extent intersects with the point `Geometry` object passed into the `filterBounds()` function.
  
  `filterBounds(ee.Geometry.Point(115.81237940701908,-31.9783567043356))`
  </p>
</details>
<br> -->
<p>Google Earth Engine allows you to specify custom <code>filter()</code> functions. The following code snippet demonstrates how to create your own filter to subset <code>Feature</code>s in the <code>perthBuildingOSM</code> <code>FeatureCollection</code> with a <code>building</code> property value of <code>'university'</code>. If you execute the following code snippet and inspect the filtered <code>FeatureCollection</code> in the <em>console</em> and the black building footprints on the map display you should see that <code>perthUniBuildingOSM</code> contains fewer <code>Feature</code>s than <code>perthBuildingOSM</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Filter OSM data to keep only university buildings</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> perthUniBuildingOSM <span class="op">=</span> perthBuildingOSM<span class="op">.</span><span class="fu">filter</span>(ee<span class="op">.</span><span class="at">Filter</span><span class="op">.</span><span class="fu">eq</span>(<span class="st">'building'</span><span class="op">,</span> <span class="st">'university'</span>))<span class="op">;</span></span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">'Uni Buildings:'</span><span class="op">,</span> perthUniBuildingOSM)<span class="op">;</span></span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a><span class="bu">Map</span><span class="op">.</span><span class="fu">addLayer</span>(perthUniBuildingOSM<span class="op">,</span> {<span class="dt">color</span><span class="op">:</span> <span class="st">'000000'</span>}<span class="op">,</span> <span class="st">'OSM university buildings'</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Let’s quickly unpack the <code>filter()</code> function. The <code>filter()</code> function takes an <code>ee.Filter.eq(name, value)</code> object as an argument. The <code>ee.Filter.eq()</code> object is constructed by specifying a name and value which correspond to the name of the property and a value that property should take for a filter’s comparison operation to evaluate to true.</p>
<br>
<details>
<summary>
<b><em>Look at the filter documentation on the <a href="https://developers.google.com/earth-engine/apidocs/ee-filter" target="_blank">Google Earth Engine documentation website</a>. Which filter would you use to return non-university building <code>Feature</code>s from <code>perthBuildingOSM</code></em></b>
</summary>
<p>
<br> <code>ee.Filter.neq()</code> - for example, <a href="https://developers.google.com/earth-engine/apidocs/ee-filter-neq" target="_blank"><code>ee.Filter.neq(“building”, “university”)</code></a>.
</p>
</details>
<p><br></p>
</section>
<section id="buffer" class="level2">
<h2 class="anchored" data-anchor-id="buffer">Buffer</h2>
<p>To compute the area of tree cover or average LST near each university building you need to define the building’s neighbourhood. You can compute this area by applying a geometric <code>buffer()</code> operation to each building’s <code>Geometry</code> object.</p>
<p>The buffer operation is a unary geometric operation as it is applied to just one geometric object. Along with the buffer operation, examples of unary operations include computing the centroid of a polygon object, simplifying geometries, or shifting or rescaling a geometry <a href="https://geocompr.robinlovelace.net/geometric-operations.html" target="_blank">(Lovelace et al.&nbsp;2020)</a>. In contrast, binary geometry operations modify a geometry based upon another; for example, clipping one geometry using the extent using the extent of another.</p>
<p>Applying a buffer to a geometry returns a polygon encompassing the area within a specified distance of the input geometry; for example, applying a 1 km buffer to a point object would return a circular polygon with a 1 km radius surrounding the point. In Google Earth Engine the <code>buffer()</code> operation can be applied to <code>Geometry</code> objects and returns a buffer polygon <code>Geometry</code> object. The <code>buffer()</code> function in Google Earth Engine has a distance parameter which is a number specifying the size of the buffer to compute (in metres unless otherwise specified).</p>
<p>Here, you will compute each building’s surrounding neighbourhood using a 50 m buffer. The following code snippet creates a function that computes a 50 m buffer for a <code>Geometry</code> object. Let’s quickly recap how user-defined functions are created in Google Earth Engine.</p>
<ol type="1">
<li><em>function name:</em> first, you have given the function an informative name that describes what it does; <code>bufferFunc</code> clearly indicates this function will compute a buffer.</li>
<li><em>parameters:</em> the function parameters are enclosed within parentheses <code>(feature)</code> following the function declaration. This function takes in a single parameter <code>feature</code> which is passed onto the operations enclosed in <code>{}</code>.</li>
<li><em>function operations:</em> the operation enclosed within this function computes the 50 m buffer for the <code>feature</code> passed into the function.</li>
<li><em>return:</em> this function <code>return</code>s a <code>Feature</code> object containing the 50 m buffered polygon surrounding the <code>Feature</code> passed into the function.</li>
</ol>
<div class="cell">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="co">// This function computes a 50 m buffer around each university building footprint</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> bufferFunc <span class="op">=</span> <span class="kw">function</span>(feature) {</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> feature<span class="op">.</span><span class="fu">buffer</span>(<span class="dv">50</span>)<span class="op">;</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>}<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>You have created a function that will compute the 50 m buffer. Next, you need to apply this function to each university building. You do this by <code>map</code>ping the function over each <code>Feature</code> in the <code>perthUniBuildingOSM</code> <code>FeatureCollection</code>. You can think of this as a “for each” operation; for each <code>Feature</code> in the <code>FeatureCollection</code> compute this function and return the result.</p>
<p>The concept of mapping a function over elements in a collection can be represented graphically:</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="img/function-map.png" class="img-fluid figure-img" style="width:70.0%"></p>
<figcaption class="figure-caption">Graphical representation of mapping a function over a collection and returning a collection as an output (source: <a href="https://adv-r.hadley.nz/index.html">Wickham (2020)</a>).</figcaption>
</figure>
</div>
</div>
</div>
<p>Each of the orange boxes is an element in a collection and <code>f</code> is a function that is applied to each element. Here, <code>f</code> is <code>bufferFunc()</code>. Mapping the function <code>f</code> over each element in the collection returns a collection.</p>
<center>
<code>buildingFootprint</code> → <b><code>bufferFunc(50)</code></b> → <code>bufferedBuildingFootprint</code><br> ↓<br> <code>buildingFootprint</code> → <b><code>bufferFunc(50)</code></b> → <code>bufferedBuildingFootprint</code><br> ↓<br> <code>buildingFootprint</code> → <b><code>bufferFunc(50)</code></b> → <code>bufferedBuildingFootprint</code><br> ↓<br> <code>buildingFootprint</code> → <b><code>bufferFunc(50)</code></b> → <code>bufferedBuildingFootprint</code><br>
</center>
<p><em>To avoid confusion, map here refers to the mathematical meaning of an “an operation that associates each element of a given set with one or more elements of a second set” and NOT representing objects in space <a href="https://adv-r.hadley.nz/index.html" target="_blank">(Wickham, 2020)</a>.</em></p>
<p>If you execute the following code snippet you will map the buffer function <code>bufferFunc</code> over each <code>Feature</code> representing a university building in the <code>FeatureCollection</code> <code>perthUniBuildingOSM</code>. This returns a <code>FeatureCollection</code> stored in the variable <code>perthUniBuildingOSMBuffer</code>. Each <code>Feature</code> in <code>perthUniBuildingOSMBuffer</code> should contain a <code>Geometry</code> object representing a 50 m buffer around a building.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co">// map buffer function over university buildings feature collection</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> perthUniBuildingOSMBuffer <span class="op">=</span> perthUniBuildingOSM<span class="op">.</span><span class="fu">map</span>(bufferFunc)<span class="op">;</span></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="bu">Map</span><span class="op">.</span><span class="fu">addLayer</span>(perthUniBuildingOSMBuffer<span class="op">,</span> {<span class="dt">color</span><span class="op">:</span> <span class="st">'33FF00'</span>}<span class="op">,</span> <span class="st">'Uni building 50 m buffer'</span>)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="img/buffer-curtin.png" class="img-fluid figure-img" style="width:85.0%"></p>
<figcaption class="figure-caption">50 m buffer (green) computed for buildings at Curtin University.</figcaption>
</figure>
</div>
</div>
</div>
</section>
<section id="zonal-statistics" class="level2">
<h2 class="anchored" data-anchor-id="zonal-statistics">Zonal Statistics</h2>
<p>You need to compute the area of tree cover and average LST surrounding each university building. You can use your buffered polygon <code>Geometry</code> objects to represent the area surrounding a building. Tree cover and LST data are in raster format. Zonal operations can be used to summarise the raster tree cover or LST values that intersect with a building’s buffer.</p>
<p>Data aggregation and summaries are computed in Google Earth Engine using reducer objects of the <code>ee.Reducer</code> class. You can find an overview of reducer functions in Google Earth Engine <a href="https://developers.google.com/earth-engine/guides/reducers_intro" target="_blank">here</a>. Reducers aggregate data over space, time, or another dimension in attribute data using an aggregation or summary function (e.g.&nbsp;mean, max, min, sum, standard deviation).</p>
<p>You the pass values for the pixels that intersect with a building’s buffer into a reducer function. There are <code>reduceRegion()</code> and <code>reduceRegions()</code> functions that can be used to summarise raster values that intersect with a specified region (i.e.&nbsp;a building’s buffer); these functions return one summary value per region.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="img/Reduce_region_diagram.png" class="img-fluid figure-img" style="width:85.0%"></p>
<figcaption class="figure-caption">Reduce region (source: <a href="https://developers.google.com/earth-engine/guides/reducers_reduce_region">Google Earth Engine developers guide</a>).</figcaption>
</figure>
</div>
</div>
</div>
<p>The following code snippet applies the <code>reduceRegions()</code> function to the <code>umTreePixelArea</code> <code>Image</code> where each pixel value is the area of tree cover in square metres. If you look at the arguments to <code>reduceRegions()</code> you will see that the regions over which raster values are summarised are taken from the <code>perthUniBuildingOSMBuffer</code> <code>FeatureCollection</code>, a sum reducer function was use to summarise the raster values, and the summary operation was performed on raster data with a spatial resolution of 0.4 metres.</p>
<p>The result of the <code>reduceRegions()</code> function is a <code>FeatureCollection</code> with the same number of <code>Features</code> as the input <code>FeatureCollection</code> but with a name:value pair in the <code>properties</code> object which contains the result of the summary of raster values within that region.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Zonal stats: reduceRegions to sum tree cover within a building's buffer</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> perthUniBuildingTree <span class="op">=</span> uniTreePixelArea<span class="op">.</span><span class="fu">reduceRegions</span>({</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>  <span class="dt">collection</span><span class="op">:</span> perthUniBuildingOSMBuffer<span class="op">,</span></span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>  <span class="dt">reducer</span><span class="op">:</span> ee<span class="op">.</span><span class="at">Reducer</span><span class="op">.</span><span class="fu">sum</span>()<span class="op">,</span></span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>  <span class="dt">scale</span><span class="op">:</span> <span class="fl">0.4</span><span class="op">,</span></span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>})<span class="op">;</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-8"><a href="#cb7-8" aria-hidden="true" tabindex="-1"></a><span class="co">// helper function to give result of reduceRegions an informative name</span></span>
<span id="cb7-9"><a href="#cb7-9" aria-hidden="true" tabindex="-1"></a>perthUniBuildingTree <span class="op">=</span> perthUniBuildingTree<span class="op">.</span><span class="fu">map</span>(<span class="kw">function</span>(feature){</span>
<span id="cb7-10"><a href="#cb7-10" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> ee<span class="op">.</span><span class="fu">Feature</span>(feature<span class="op">.</span><span class="fu">geometry</span>()<span class="op">,</span> { </span>
<span id="cb7-11"><a href="#cb7-11" aria-hidden="true" tabindex="-1"></a>    <span class="dt">building</span><span class="op">:</span> feature<span class="op">.</span><span class="fu">get</span>(<span class="st">'building'</span>)<span class="op">,</span></span>
<span id="cb7-12"><a href="#cb7-12" aria-hidden="true" tabindex="-1"></a>    <span class="dt">osm_id</span><span class="op">:</span> feature<span class="op">.</span><span class="fu">get</span>(<span class="st">'osm_id'</span>)<span class="op">,</span></span>
<span id="cb7-13"><a href="#cb7-13" aria-hidden="true" tabindex="-1"></a>    <span class="dt">uni_name</span><span class="op">:</span> feature<span class="op">.</span><span class="fu">get</span>(<span class="st">'uni_name'</span>)<span class="op">,</span></span>
<span id="cb7-14"><a href="#cb7-14" aria-hidden="true" tabindex="-1"></a>    <span class="dt">treeAreaSqM</span><span class="op">:</span> feature<span class="op">.</span><span class="fu">get</span>(<span class="st">'sum'</span>)</span>
<span id="cb7-15"><a href="#cb7-15" aria-hidden="true" tabindex="-1"></a>  })<span class="op">;</span></span>
<span id="cb7-16"><a href="#cb7-16" aria-hidden="true" tabindex="-1"></a>})<span class="op">;</span></span>
<span id="cb7-17"><a href="#cb7-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-18"><a href="#cb7-18" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">'zonal stats - tree area:'</span><span class="op">,</span> perthUniBuildingTree)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>You can perform a similar <code>reduceRegions()</code> operation to compute average LST surrounding each university building. Inspect the results of the <code>reduceRegions()</code> in the <em>console</em>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Zonal stats: reduceRegions to average LST within a building's buffer</span></span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> perthUniBuildingLST <span class="op">=</span> landsatLST<span class="op">.</span><span class="fu">reduceRegions</span>({</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>  <span class="dt">collection</span><span class="op">:</span> perthUniBuildingOSMBuffer<span class="op">,</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>  <span class="dt">reducer</span><span class="op">:</span> ee<span class="op">.</span><span class="at">Reducer</span><span class="op">.</span><span class="fu">mean</span>()<span class="op">,</span></span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a>  <span class="dt">scale</span><span class="op">:</span> <span class="fl">0.4</span><span class="op">,</span></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a>})<span class="op">;</span></span>
<span id="cb8-7"><a href="#cb8-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-8"><a href="#cb8-8" aria-hidden="true" tabindex="-1"></a><span class="co">// helper function to give result of reduceRegions an informative name</span></span>
<span id="cb8-9"><a href="#cb8-9" aria-hidden="true" tabindex="-1"></a>perthUniBuildingLST <span class="op">=</span> perthUniBuildingLST<span class="op">.</span><span class="fu">map</span>(<span class="kw">function</span>(feature){</span>
<span id="cb8-10"><a href="#cb8-10" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> ee<span class="op">.</span><span class="fu">Feature</span>(feature<span class="op">.</span><span class="fu">geometry</span>()<span class="op">,</span> { </span>
<span id="cb8-11"><a href="#cb8-11" aria-hidden="true" tabindex="-1"></a>    <span class="dt">building</span><span class="op">:</span> feature<span class="op">.</span><span class="fu">get</span>(<span class="st">'building'</span>)<span class="op">,</span></span>
<span id="cb8-12"><a href="#cb8-12" aria-hidden="true" tabindex="-1"></a>    <span class="dt">osm_id</span><span class="op">:</span> feature<span class="op">.</span><span class="fu">get</span>(<span class="st">'osm_id'</span>)<span class="op">,</span></span>
<span id="cb8-13"><a href="#cb8-13" aria-hidden="true" tabindex="-1"></a>    <span class="dt">uni_name</span><span class="op">:</span> feature<span class="op">.</span><span class="fu">get</span>(<span class="st">'uni_name'</span>)<span class="op">,</span></span>
<span id="cb8-14"><a href="#cb8-14" aria-hidden="true" tabindex="-1"></a>    <span class="dt">lstK</span><span class="op">:</span> feature<span class="op">.</span><span class="fu">get</span>(<span class="st">'mean'</span>)</span>
<span id="cb8-15"><a href="#cb8-15" aria-hidden="true" tabindex="-1"></a>  })<span class="op">;</span></span>
<span id="cb8-16"><a href="#cb8-16" aria-hidden="true" tabindex="-1"></a>})<span class="op">;</span></span>
<span id="cb8-17"><a href="#cb8-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-18"><a href="#cb8-18" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">'zonal stats - ave. LST:'</span><span class="op">,</span> perthUniBuildingLST)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<br>
<details>
<summary>
<b><em>What is different about the reducer used to compute average LST for a building’s buffer?</em></b>
</summary>
<p>
<br> Instead of using a sum reducer which sums all the raster values that intersect with the region a mean reducer was used which computes the average of all raster values that intersect with a region - <code>ee.Reducer.mean()</code>.
</p>
</details>
<p><br></p>
</section>
<section id="join" class="level2">
<h2 class="anchored" data-anchor-id="join">Join</h2>
<p>You now have four <code>FeatureCollection</code>s that contain information about university buildings:</p>
<ul>
<li><code>perthUniBuildingOSM</code>: the <code>Geometry</code> objects for university building footprints.</li>
<li><code>perthUniBuildingOSMBuffer</code>: the <code>Geometry</code> objects for each university building’s polygon buffer.</li>
<li><code>perthUniBuildingTree</code>: <code>Geometry</code> objects for each university building’s polygon buffer and a <code>properties</code> dictionary with the area of tree cover within each buffer.</li>
<li><code>perthUniBuildingLST</code>: <code>Geometry</code> objects for each university building’s polygon buffer and a <code>properties</code> dictionary with the average LST within each buffer.</li>
</ul>
<p>You need to combine these <code>FeatureCollection</code>s into one data set without duplicating <code>Feature</code>s.</p>
<p>You can use join operations to combine elements in a <code>FeatureCollection</code> through matching observations based on a common variable in both data sets (if you are familiar with relational database management systems this common variable(s) is often called a key - in Google Earth Engine these variables are called <code>leftField</code> and <code>rightField</code>).</p>
<p>In Google Earth Engine what constitutes a match, between observations in two data sets, is determined by an <code>ee.Filter()</code> object; an <code>ee.Filter.eq()</code> object would join the attributes for two <code>Feature</code>s if their values for the specified <code>leftField</code> and <code>rightField</code> are equivalent. The graphic below illustrates the concept of joining two data sets based upon matching values in a common variable.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="img/inner-join.png" class="img-fluid figure-img" style="width:70.0%"></p>
<figcaption class="figure-caption">Illustration of an inner join between two data sets based upon matching values in a common field (source: <a href="https://r4ds.had.co.nz">Wickham and Grolemund (2017)</a>).</figcaption>
</figure>
</div>
</div>
</div>
<p>The first step is to specify an <code>ee.Filter.equals()</code> object that will match values in a common field between two <code>Feature</code> objects. You can use the <code>osm_id</code> property which uniquely identifies a building object to match common buildings across <code>FeatureCollection</code>s.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Use an equals filter to specify how the collections match.</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> osmFilter <span class="op">=</span> ee<span class="op">.</span><span class="at">Filter</span><span class="op">.</span><span class="fu">equals</span>({</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>  <span class="dt">leftField</span><span class="op">:</span> <span class="st">'osm_id'</span><span class="op">,</span></span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>  <span class="dt">rightField</span><span class="op">:</span> <span class="st">'osm_id'</span></span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>})<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>Next, you need to specify the type of join to apply. Here, you will use an inner join which keeps all the attributes from both <code>FeatureCollection</code>s being joined where there are matching observations for the joining field <code>osm_id</code>.</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Define the join.</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> innerJoin <span class="op">=</span> ee<span class="op">.</span><span class="at">Join</span><span class="op">.</span><span class="fu">inner</span>(<span class="st">'primary'</span><span class="op">,</span> <span class="st">'secondary'</span>)<span class="op">;</span></span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a><span class="co">// Apply the join.</span></span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> lstTreeJoin <span class="op">=</span> innerJoin<span class="op">.</span><span class="fu">apply</span>(perthUniBuildingTree<span class="op">,</span> perthUniBuildingLST<span class="op">,</span> osmFilter)<span class="op">;</span></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">'joined:'</span><span class="op">,</span> lstTreeJoin)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>The matching <code>Feature</code>s from <code>perthUniBuildingTree</code> and <code>perthUniBuildingLST</code> are stored in a <code>primary</code> and <code>secondary</code> dictionary object of the output from the join. Execute the following helper function to add the name:value pairs in <code>secondary</code> to the <code>properties</code> in the <code>primary</code> dictionary. This puts all your name:value pairs in one <code>properties</code> dictionary and makes it easy for you to query, summarise, and visualise this data. You can inspect the tidied <code>FeatureCollection</code> in the <em>console</em> to see the output from this function.</p>
<p><em>Not necessary, but it might be a good activity to consolidate understanding: work through the function in the below code snippet and describe what each line is doing.</em></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="co">// tidy up properties of output from join</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>lstTreeJoin <span class="op">=</span> lstTreeJoin<span class="op">.</span><span class="fu">map</span>(<span class="kw">function</span>(feature) {</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>  <span class="kw">var</span> f1 <span class="op">=</span> ee<span class="op">.</span><span class="fu">Feature</span>(feature<span class="op">.</span><span class="fu">get</span>(<span class="st">'primary'</span>))<span class="op">;</span></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>  <span class="kw">var</span> f2 <span class="op">=</span> ee<span class="op">.</span><span class="fu">Feature</span>(feature<span class="op">.</span><span class="fu">get</span>(<span class="st">'secondary'</span>))<span class="op">;</span></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> f1<span class="op">.</span><span class="fu">set</span>(f2<span class="op">.</span><span class="fu">toDictionary</span>())<span class="op">;</span></span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>})<span class="op">;</span></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">'joined and tidied:'</span><span class="op">,</span> lstTreeJoin)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section>
<section id="descriptive-statistics" class="level2">
<h2 class="anchored" data-anchor-id="descriptive-statistics">Descriptive Statistics</h2>
<p>You have now transformed your raw data (open street map buildings near Perth university campuses, a raster layer of tree cover, and a raster layer of LST) into a format where you can answer the question at the beginning of the lab: <em>Which Perth university has the greenest and coolest campus?</em></p>
<p>Your <code>FeatureCollection</code>, <code>lstTreeJoin</code>, should contain 215 <code>Feature</code>s with each <code>Feature</code> comprising a <code>Geometry</code> object and a dictionary of <code>properties</code>: <code>building</code>, <code>osm_id</code>, <code>uni_name</code>, <code>lstK</code>, and <code>treeAreaSqM</code>. One approach to addressing the question is to perform a <em>group by</em> and <em>summarise</em> operation. Group your data by the <code>uni_name</code> property and compute summary statistics for all observations within each group. Comparing the summary statistics between groups would indicate which university campus has buildings that are surrounded by more trees and cooler temperatures.</p>
<p>You have already used <a href="https://developers.google.com/earth-engine/guides/reducers_intro" target="_blank">reducers</a> in Google Earth Engine to aggregate values across space. There are other useful reducer functions: <a href="https://developers.google.com/earth-engine/guides/reducers_reduce_columns" target="_blank"><code>reduceColumns()</code></a> aggregates values in <code>FeatureCollection</code> <code>properties</code> and a <a href="https://developers.google.com/earth-engine/guides/reducers_grouping" target="_blank"><code>reducer.group()</code></a> applies summary operations to groups of observations.</p>
<p>The following code snippet demonstrates how to apply <code>reduceColumns()</code> to the <code>FeatureCollection</code> <code>lstTreeJoin</code>. Let’s go through this snippet line by line:</p>
<p>The <code>reduceColumns()</code> function has a:</p>
<ul>
<li><code>selectors</code> parameter which is a list of <code>properties</code> that the reducer will group by and summarise values for.</li>
<li>a <code>reducer</code> parameter which specifies the type of reducer function that will be applied to the <code>properties</code> specified in the <code>selectors</code> argument.</li>
<li>pass a mean reducer <code>ee.Reducer.mean()</code> as the reducer argument into <code>reduceColumns()</code> indicating you want to aggregate values using the mean function.</li>
<li>specify <code>repeat(2)</code> to apply this reducer twice (one reducer for <code>'treeAreaSqM'</code> and one reducer for <code>'lstK'</code>).</li>
<li>use <code>.group({.......})</code> to define how to group <code>Feature</code>s in your <code>FeatureCollection</code> before reducing their values. <code>groupField</code> specifies the grouping property in <code>selectors</code> (index location 2 corresponds to the third element in the list - <code>uni_name</code>). <code>groupName</code> is the name of the property for the grouping variable in the output.</li>
</ul>
<p><br></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a><span class="co">// group by and summarise tree area and LST within each university campus</span></span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> campusSummaryStats <span class="op">=</span> lstTreeJoin<span class="op">.</span><span class="fu">reduceColumns</span>({</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>    <span class="dt">selectors</span><span class="op">:</span> [<span class="st">'treeAreaSqM'</span><span class="op">,</span> <span class="st">'lstK'</span><span class="op">,</span> <span class="st">'uni_name'</span>]<span class="op">,</span></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>    <span class="dt">reducer</span><span class="op">:</span> ee<span class="op">.</span><span class="at">Reducer</span><span class="op">.</span><span class="fu">mean</span>()<span class="op">.</span><span class="fu">repeat</span>(<span class="dv">2</span>)<span class="op">.</span><span class="fu">group</span>({</span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>      <span class="dt">groupField</span><span class="op">:</span> <span class="dv">2</span><span class="op">,</span></span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>      <span class="dt">groupName</span><span class="op">:</span> <span class="st">'uni_name'</span></span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>    })</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a>})<span class="op">;</span></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(campusSummaryStats)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>If you inspect the <code>print()</code> of <code>campusSummaryStats</code> in the <em>console</em> you will see that it returned a dictionary object which contains a list of dictionary objects. This is an unfriendly data structure for storing and querying the data it contains.</p>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="img/unfriendly-data-structure.png" class="img-fluid figure-img" style="width:85.0%"></p>
<figcaption class="figure-caption">Structure of data returned by grouped reduceColumns().</figcaption>
</figure>
</div>
</div>
</div>
<p>The following code snippet tidys up this data returning a <code>FeatureCollection</code> where each <code>Feature</code> has a null <code>geometry</code> property and a dictionary of <code>properties</code>: <code>uni_name</code>, <code>lstK</code>, and <code>treeAreaSqM</code>.</p>
<p><em>Again, it is not necessary to understand what is going on here but working through it line by line would be a good extra exercise to consolidate understanding of programmatically transforming data into more friendly formats.</em></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="co">// tidy up campus summary stats</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> campusSummaryStats <span class="op">=</span> ee<span class="op">.</span><span class="fu">Dictionary</span>(campusSummaryStats)<span class="op">.</span><span class="fu">values</span>()<span class="op">;</span></span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> campusSummaryStatsFlat <span class="op">=</span> ee<span class="op">.</span><span class="fu">List</span>(campusSummaryStats)<span class="op">.</span><span class="fu">flatten</span>()<span class="op">;</span></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> tidySummaryStats <span class="op">=</span> <span class="kw">function</span>(listElement) {</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>  <span class="kw">var</span> groups <span class="op">=</span> ee<span class="op">.</span><span class="fu">Dictionary</span>()<span class="op">;</span></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>  <span class="kw">var</span> stats <span class="op">=</span> ee<span class="op">.</span><span class="fu">Dictionary</span>(listElement)<span class="op">.</span><span class="fu">get</span>(<span class="st">'mean'</span>)<span class="op">;</span></span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>  <span class="kw">var</span> treeArea <span class="op">=</span> ee<span class="op">.</span><span class="fu">List</span>(stats)<span class="op">.</span><span class="fu">get</span>(<span class="dv">0</span>)<span class="op">;</span></span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>  <span class="kw">var</span> temp <span class="op">=</span> ee<span class="op">.</span><span class="fu">List</span>(stats)<span class="op">.</span><span class="fu">get</span>(<span class="dv">1</span>)<span class="op">;</span></span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>  <span class="kw">var</span> uni <span class="op">=</span> ee<span class="op">.</span><span class="fu">Dictionary</span>(listElement)<span class="op">.</span><span class="fu">get</span>(<span class="st">'uni_name'</span>)<span class="op">;</span></span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>  groups <span class="op">=</span> groups<span class="op">.</span><span class="fu">set</span>(<span class="st">'uni_name'</span><span class="op">,</span> uni)</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">set</span>(<span class="st">'treeAreaSqM'</span><span class="op">,</span> treeArea)</span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">set</span>(<span class="st">'lstK'</span><span class="op">,</span> temp)<span class="op">;</span></span>
<span id="cb13-14"><a href="#cb13-14" aria-hidden="true" tabindex="-1"></a>  <span class="kw">var</span> groupsFeat <span class="op">=</span> ee<span class="op">.</span><span class="fu">Feature</span>(<span class="kw">null</span><span class="op">,</span> groups)<span class="op">;</span> </span>
<span id="cb13-15"><a href="#cb13-15" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> groupsFeat<span class="op">;</span></span>
<span id="cb13-16"><a href="#cb13-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb13-17"><a href="#cb13-17" aria-hidden="true" tabindex="-1"></a>}<span class="op">;</span></span>
<span id="cb13-18"><a href="#cb13-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-19"><a href="#cb13-19" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> tidyCampusStats <span class="op">=</span> campusSummaryStatsFlat<span class="op">.</span><span class="fu">map</span>(tidySummaryStats)<span class="op">;</span></span>
<span id="cb13-20"><a href="#cb13-20" aria-hidden="true" tabindex="-1"></a>tidyCampusStats <span class="op">=</span> ee<span class="op">.</span><span class="fu">FeatureCollection</span>(tidyCampusStats)<span class="op">;</span></span>
<span id="cb13-21"><a href="#cb13-21" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(<span class="st">'tidy campus stats:'</span><span class="op">,</span> tidyCampusStats)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="img/tidy-data-structure.png" class="img-fluid figure-img" style="width:85.0%"></p>
<figcaption class="figure-caption">Tidier data structure for storing the results of grouped reduceColumns().</figcaption>
</figure>
</div>
</div>
</div>
<p>Let’s look at the results. You should have <code>print()</code>ed <code>tidyCampusStats</code> onto the <em>console</em>. The <code>properties</code> object for each <code>Feature</code> stores the average area of tree canopy cover and LST within a 50 m buffer of buildings on each university campus. The figure above shows that, on average, buildings on Curtin University’s Bentley Campus have an LST of 307.47 K. Look at the values reported for the other university campuses.</p>
</section>
<section id="visualisation" class="level2">
<h2 class="anchored" data-anchor-id="visualisation">Visualisation</h2>
<p>To make comparisons between campuses in terms of their greenness and coolness, you can look up the values in the <em>console</em> for the <code>properties</code> object storing the results of the group by and summarise operations. However, this is not a visually friendly way to inspect your data. Google Earth Engine provides a range of tools to generate <a href="https://developers.google.com/earth-engine/guides/charts" target="_blank">interactive charts</a> from spatial data.</p>
<p>Chart objects can be rendered in the <em>console</em> to visualise your data. The <code>ui.Chart.feature.byFeature()</code> function creates a chart from a set of <code>Feature</code>s in a <code>FeatureCollection</code> plotting each <code>Feature</code> on the X-axis and the value for a <code>Feature</code>’s property on the Y-axis.</p>
<p>The first argument to the <code>ui.Chart.feature.byFeature()</code> function is the <code>FeatureCollection</code> - <code>tidyCampusStats</code>. The second argument to <code>ui.Chart.feature.byFeature()</code> is the label property for <code>Feature</code>s plotted on the X-axis - <code>'uni_name'</code>. The final argument is a list object of properties whose values are plotted on the Y-axis - <code>['treeAreaSqM']</code>.</p>
<p>Use the <code>.setChartType()</code> method to specify the type of chart to create. View possible charts in this <a href="https://developers.google.com/chart/interactive/docs/gallery" target="_blank">gallery</a>. A dictionary of name:value pairs is passed into the <code>setOptions()</code> method to control various style elements of the chart (e.g.&nbsp;chart title, axis title).</p>
<p>To render your chart in the <em>console</em> use the <code>print()</code> function.</p>
<p><br></p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Make a chart by feature</span></span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> treeColumnChart <span class="op">=</span></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>  ui<span class="op">.</span><span class="at">Chart</span><span class="op">.</span><span class="at">feature</span><span class="op">.</span><span class="fu">byFeature</span>(tidyCampusStats<span class="op">,</span> <span class="st">'uni_name'</span><span class="op">,</span> [<span class="st">'treeAreaSqM'</span>])</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">setChartType</span>(<span class="st">'ColumnChart'</span>)</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">setSeriesNames</span>([<span class="st">''</span>])</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">setOptions</span>({</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>      <span class="dt">title</span><span class="op">:</span> <span class="st">'Average tree cover near university buildings (SqM)'</span><span class="op">,</span></span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>      <span class="dt">hAxis</span><span class="op">:</span> {<span class="dt">title</span><span class="op">:</span> <span class="st">'Uni. Campus'</span>}<span class="op">,</span></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>      <span class="dt">vAxis</span><span class="op">:</span> {<span class="dt">title</span><span class="op">:</span> <span class="st">'Tree Cover (SqM)'</span>}</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>    })<span class="op">;</span></span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(treeColumnChart)<span class="op">;</span></span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a><span class="co">// Make a chart by feature.</span></span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> lstColumnChart <span class="op">=</span></span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a>  ui<span class="op">.</span><span class="at">Chart</span><span class="op">.</span><span class="at">feature</span><span class="op">.</span><span class="fu">byFeature</span>(tidyCampusStats<span class="op">,</span> <span class="st">'uni_name'</span><span class="op">,</span> [<span class="st">'lstK'</span>])</span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">setChartType</span>(<span class="st">'ColumnChart'</span>)</span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">setSeriesNames</span>([<span class="st">''</span>])</span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">setOptions</span>({</span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a>      <span class="dt">title</span><span class="op">:</span> <span class="st">'Average LST near university buildings (K)'</span><span class="op">,</span></span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true" tabindex="-1"></a>      <span class="dt">hAxis</span><span class="op">:</span> {<span class="dt">title</span><span class="op">:</span> <span class="st">'Uni. Campus'</span>}<span class="op">,</span></span>
<span id="cb14-23"><a href="#cb14-23" aria-hidden="true" tabindex="-1"></a>      <span class="dt">vAxis</span><span class="op">:</span> {<span class="dt">title</span><span class="op">:</span> <span class="st">'LST (K)'</span>}</span>
<span id="cb14-24"><a href="#cb14-24" aria-hidden="true" tabindex="-1"></a>    })<span class="op">;</span></span>
<span id="cb14-25"><a href="#cb14-25" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb14-26"><a href="#cb14-26" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(lstColumnChart)<span class="op">;</span>  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="img/tree-chart.png" class="img-fluid figure-img" style="width:85.0%"></p>
<figcaption class="figure-caption">Average area of tree cover within a 50 m buffer of buildings on university campuses.</figcaption>
</figure>
</div>
</div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="img/lst-chart.png" class="img-fluid figure-img" style="width:85.0%"></p>
<figcaption class="figure-caption">Average LST (K) within a 50 m buffer of buildings on university campuses.</figcaption>
</figure>
</div>
</div>
</div>
<p>The <code>ui.Chart.feature.groups()</code> function creates a chart from a set of <code>Feature</code>s in a <code>FeatureCollection</code> plotting values for <code>Feature</code> properties on the X-axis and Y-axis. This chart can be used to visualise the relationships between variables stored in <code>FeatureCollection</code> data.</p>
<p>The first argument to the <code>ui.Chart.feature.groups()</code> function is the <code>FeatureCollection</code> - <code>lstTreeJoin</code> here as we want to visualise data for individual univeristy buildings. The second argument to <code>ui.Chart.feature.groups()</code> is the property to be plotted on the X-axis - <code>'treeAreaSqM'</code>. The third argument to <code>ui.Chart.feature.groups()</code> is the property to be plotted on the Y-axis - <code>'lstK'</code>. The final argument is the series property used to determine groups within the data - <code>'uni_name'</code> here (setting this argument will mean each University’s data points will be rendered in different colours).</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="co">// Make a scatter chart</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="kw">var</span> tempVsTree <span class="op">=</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>  ui<span class="op">.</span><span class="at">Chart</span><span class="op">.</span><span class="at">feature</span><span class="op">.</span><span class="fu">groups</span>(lstTreeJoin<span class="op">,</span> <span class="st">'treeAreaSqM'</span><span class="op">,</span> <span class="st">'lstK'</span><span class="op">,</span> <span class="st">'uni_name'</span>)</span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">setChartType</span>(<span class="st">'ScatterChart'</span>)</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">setOptions</span>({</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a>      <span class="dt">title</span><span class="op">:</span> <span class="st">''</span><span class="op">,</span></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>      <span class="dt">hAxis</span><span class="op">:</span> {<span class="dt">title</span><span class="op">:</span> <span class="st">'Building neighbourhood tree cover (SqM)'</span>}<span class="op">,</span></span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>      <span class="dt">vAxis</span><span class="op">:</span> {<span class="dt">title</span><span class="op">:</span> <span class="st">'Temperature (K)'</span>}</span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>    })<span class="op">;</span></span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a><span class="fu">print</span>(tempVsTree)<span class="op">;</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div class="cell" data-layout-align="center">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="img/lst-tree-scatter.png" class="img-fluid figure-img" style="width:85.0%"></p>
<figcaption class="figure-caption">Scatter chart showing the relationship between average LST (K) and tree cover (SqM) within a 50 m buffer of buildings on university campuses.</figcaption>
</figure>
</div>
</div>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="./colour-vis.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-title">Color and Data Visualisation</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
  </div>
</nav>
</div> <!-- /content -->



</body></html>